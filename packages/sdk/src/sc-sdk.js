!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.sc=t():e.sc=t()}(self,(function(){return(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.d(t,{default:()=>q});var n={};e.r(n),e.d(n,{AppEventNames:()=>E,AppEventParameterNames:()=>I,AvatarVariants:()=>_,BitmojiVariants:()=>T,ClientEventNames:()=>S,ErrorCodes:()=>v,MiniEventNames:()=>A,PermissionScope:()=>g,PermissionValue:()=>m});var o,r=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},i=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},a=function(){function e(e,t,n,o){this._parent=e,this._name=t,this.callback=n,this.scope=o,this.once=!1}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),e.prototype.unbind=function(){if(this._parent){var e=this._parent._callbacks[this._name].indexOf(this);-1!==e&&(this._parent._callbackActive[this._name]&&this._parent._callbackActive[this._name]===this._parent._callbacks[this._name]&&(this._parent._callbackActive[this._name]=this._parent._callbackActive[this._name].slice()),this._parent._callbacks[this._name].splice(e,1),this._parent=null,this.callback=null,this.scope=null)}},e}(),s=function(){function e(){this._callbacks={},this._callbackActive={}}return e.prototype.on=function(e,t,n){if(e&&"string"==typeof e&&t){this._callbacks[e]||(this._callbacks[e]=[]),this._callbackActive[e]&&this._callbackActive[e]===this._callbacks[e]&&(this._callbackActive[e]=this._callbackActive[e].slice());var o=new a(this,e,t,n||this);return this._callbacks[e].push(o),o}},e.prototype.once=function(e,t,n){var o=this.on(e,t,n);if(o)return o.once=!0,o},e.prototype.unbind=function(e,t,n){if(e)this._callbackActive[e]&&this._callbackActive[e]===this._callbacks[e]&&(this._callbackActive[e]=this._callbackActive[e].slice());else for(var o in this._callbackActive)this._callbacks[o]&&this._callbacks[o]===this._callbackActive[o]&&(this._callbackActive[o]=this._callbackActive[o].slice());if(!e)return this._callbacks={},this;if(!t)return delete this._callbacks[e],this;var r=this._callbacks[e];if(!r)return this;for(var i=r.length;i--;)r[i].callback!==t||n&&r[i].scope!==n||r[i].unbind();return this},e.prototype.emit=function(e){for(var t,n,o=[],a=1;a<arguments.length;a++)o[a-1]=arguments[a];if(!e||!this._callbacks[e])return this;this._callbackActive[e]?(this._callbackActive[e]===this._callbacks[e]&&(this._callbackActive[e]=this._callbackActive[e].slice()),n=this._callbacks[e].slice()):this._callbackActive[e]=this._callbacks[e];for(var s=0;s<(n||this._callbackActive[e]).length;s++){var c=(n||this._callbackActive[e])[s];c.callback&&(t=c.callback).call.apply(t,i([c.scope],r(o),!1)),c.once&&c.unbind()}return n||delete this._callbackActive[e],this},e}(),c=(o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},o(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),u=function(e){function t(){var t=e.call(this)||this;return t._user=void 0,t._id=void 0,t._context=void 0,t._env=void 0,t._sessionId=void 0,t._conversationSize=0,t._locale=void 0,t._safeAreaInsets={top:0,bottom:0},t._windowSafeAreaInsets={top:0,bottom:0},t._authToken=void 0,t._authTokenExpiration=0,t._volume=0,t._isAgeValid=void 0,t}return c(t,e),Object.defineProperty(t.prototype,"user",{get:function(){return this._user},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"context",{get:function(){return this._context},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"env",{get:function(){return this._env},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sessionId",{get:function(){return this._sessionId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"conversationSize",{get:function(){return this._conversationSize},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"locale",{get:function(){return this._locale},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"safeAreaInsets",{get:function(){return this._safeAreaInsets},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"windowSafeAreaInsets",{get:function(){return this._windowSafeAreaInsets},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"authTokenExpiration",{get:function(){return this._authTokenExpiration},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"volume",{get:function(){return this._volume},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"authToken",{get:function(){return this._authToken},set:function(e){if(!e)return this._authToken=e,void(this._authTokenExpiration=0);this._authToken=e;var t=JSON.parse(atob(e.split(".")[1]));this._authTokenExpiration=(new Date).getTime()+1e3*(parseInt(t.exp)-parseInt(t.iat)+10)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isAgeValid",{get:function(){return this._isAgeValid},set:function(e){this._isAgeValid=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"discoverableFriends",{get:function(){return this._discoverableFriends},set:function(e){this._discoverableFriends=e},enumerable:!1,configurable:!0}),t.prototype.updateSession=function(e,t,n){this.authToken=void 0,this._sessionId=e,this._conversationSize=t,this._context=n,this._discoverableFriends=void 0},t}(s),l=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),d=function(e){function t(t,n,o,r){void 0===r&&(r="#FFFFFF");var i=e.call(this)||this;return i.id=t,i.avatarId=n,i.name=o,i.color=r,i}return l(t,e),t}(s);function p(e){return sc._fetchOAuth2Token().then((function(t){if(t.token){var n="Bearer ".concat(t.token);return fetch("https://us-central1-gcp.api.snapchat.com/canvasapi/graphql",{method:"POST",headers:{"Content-Type":"application/json",Authorization:n},body:JSON.stringify({query:e})})}throw{code:sc.ErrorCodes.INTERNAL_ERROR}})).then((function(e){if(200!=e.status)throw{code:sc.ErrorCodes.NETWORK_FAILURE};return e.json()})).then((function(e){var t,n,o,r,i,a;if(null==(null===(t=e.errors)||void 0===t?void 0:t[0]))return e;var s=null===(r=null===(o=null===(n=e.errors)||void 0===n?void 0:n[0])||void 0===o?void 0:o.extensions)||void 0===r?void 0:r.code,c=null===(a=null===(i=e.errors)||void 0===i?void 0:i[0])||void 0===a?void 0:a.message;switch(s){case"INTERNAL_ERROR":default:throw{code:sc.ErrorCodes.INTERNAL_ERROR,message:c};case"RATE_LIMITED":throw{code:sc.ErrorCodes.RATE_LIMITED,message:c};case"UNAUTHORIZED_APP":throw{code:sc.ErrorCodes.INVALID_CONFIG,message:c};case"UNAUTHORIZED_USER":throw{code:sc.ErrorCodes.UNAUTHORIZED_USER,message:c}}}))}function f(){return p("query { me { ageGate } }").then((function(e){var t,n;if(void 0!==(null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.me)||void 0===n?void 0:n.ageGate))return sc.app.isAgeValid=e.data.me.ageGate,{isAgeValid:e.data.me.ageGate};throw sc.ErrorCodes.INTERNAL_ERROR}))}function h(e,t){return void 0===t&&(t=1),e().catch((function(n){if(t<=1)throw n;return h(e,t-1)}))}var _,v,S,E,A,I,T,m,g,b=function(){return p("query { me { discoverable { ".concat("discoverableFriends { abbreviatedDisplayName externalAvatarID externalUserID }"," } } }")).then((function(e){var t,n,o,r=null===(o=null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.me)||void 0===n?void 0:n.discoverable)||void 0===o?void 0:o.discoverableFriends;if(r){var i=r.map((function(e){return{id:e.externalUserID,name:e.abbreviatedDisplayName,avatarId:e.externalAvatarID}}));return sc.app.discoverableFriends=i,{friends:i}}throw{code:sc.ErrorCodes.INTERNAL_ERROR}}))};!function(e){e.DEFAULT="20004322",e.HAPPY="20004321",e.BORED="10226843",e.LAUGHINGCRY="20004320",e.CRY="20004319",e.SHOCK="20004318",e.SAD="10232166",e.THINKING="20004317",e.SURPRISE="20004323",e.YAWN="20004324",e.CHEEKY="20004325",e.RELAX="20004326",e.CONFUSED="20004327",e.DEER="20004329",e.CAT="20004331",e.DOG="20004332",e.HALO="20004333",e.RAINBOW="20004336",e.MONEYEYES="20004337",e.WINK="10212039",e.GRIN="10212371",e.ANGRY="10212034",e.WAVE="10211812",e.KISS="10212029",e.HEARTEYES="10227009",e.SUNGLASSES="10223291",e.EVIL="10221921",e.PEEK="10208529",e.SLEEP="10212036",e.SHH="10219373",e.ROLL="10212047",e.SWEAT="10218905",e.CROWN="10219581",e.HEARTBREAK="10227483",e.STAYTUNED="10214712",e.SHRUG="9422789",e.EMBARRASSED="10228567"}(_||(_={})),function(e){e.CLIENT_STATE_INVALID="CLIENT_STATE_INVALID",e.CLIENT_UNSUPPORTED="CLIENT_UNSUPPORTED",e.CONFLICT_REQUEST="CONFLICT_REQUEST",e.INVALID_PARAM="INVALID_PARAM",e.INTERNAL_ERROR="INTERNAL_ERROR",e.LENS_UNLOCK_FAILURE="LENS_UNLOCK_FAILURE",e.NETWORK_FAILURE="NETWORK_FAILURE",e.NETWORK_NOT_REACHABLE="NETWORK_NOT_REACHABLE",e.RATE_LIMITED="RATE_LIMITED",e.RESOURCE_NOT_AVAILABLE="RESOURCE_NOT_AVAILABLE",e.RESOURCE_NOT_FOUND="RESOURCE_NOT_FOUND",e.RV_NO_FILL="RV_NO_FILL",e.RV_NO_MATCH="RV_NO_MATCH",e.RV_NOT_LOADED="RV_NOT_LOADED",e.RV_RATE_LIMITED="RV_RATE_LIMITED",e.TOKEN_REVOKED_BY_SERVER="TOKEN_REVOKED_BY_SERVER",e.USER_PERMISSION_NOT_GRANTED="USER_PERMISSION_NOT_GRANTED",e.USER_REJECTION="USER_REJECTION",e.UNKNOWN_SCRIPT="UNKNOWN_SCRIPT",e.UNAUTHORIZED_USER="UNAUTHORIZED_USER",e.INVALID_CONFIG="INVALID_CONFIG",e.SHORTCUT_ADDED="SHORTCUT_ADDED"}(v||(v={})),function(e){e.VOLUME_CHANGED="volumeChanged",e.AD_READY="adReady",e.AD_COMPLETE="adComplete",e.DID_LOSE_FOCUS="didLoseFocus",e.DID_GAIN_FOCUS="didGainFocus",e.SAFE_AREA_DID_UPDATE="safeAreaDidUpdate",e.DID_PRESENT_LEADERBOARD="didPresentLeaderboard",e.DID_DISMISS_LEADERBOARD="didDismissLeaderboard",e.DID_DISMISS_LENS="didDismissLens",e.CREATE_SHORTCUT_COMPLETE="createShortcutComplete",e.PERMISSIONS_DID_UPDATE="permissionsDidUpdate"}(S||(S={})),function(e){e.ONBOARDING_START="ONBOARDING_START",e.ONBOARDING_STAGE_COMPLETE="ONBOARDING_STAGE_COMPLETE",e.ONBOARDING_COMPLETE="ONBOARDING_COMPLETE",e.CLICK_PLAY="CLICK_PLAY",e.MATCH_START="MATCH_START",e.MATCH_END="MATCH_END",e.SHOP_START="SHOP_START",e.SHOP_EXIT="SHOP_EXIT",e.SHOP_TRANSACTION="SHOP_TRANSACTION"}(E||(E={})),function(e){e.VIEW_CONTENT="VIEW_CONTENT",e.RATE="RATE",e.RESERVE="RESERVE",e.SEARCH="SEARCH",e.PAGE_VIEW="PAGE_VIEW",e.LIST_VIEW="LIST_VIEW",e.COMPLETE_TUTORIAL="COMPLETE_TUTORIAL",e.LEVEL_COMPLETE="LEVEL_COMPLETE",e.ACHIEVEMENT_UNLOCKED="ACHIEVEMENT_UNLOCKED",e.SIGN_UP="SIGN_UP",e.LOGIN="LOGIN",e.PURCHASE="PURCHASE",e.SUBSCRIBE="SUBSCRIBE",e.SPEND_CREDIT="SPEND_CREDIT",e.START_TRIAL="START_TRIAL",e.ADD_TO_WISHLIST="ADD_TO_WISHLIST",e.START_CHECKOUT="START_CHECKOUT",e.EXIT_CHECKOUT="EXIT_CHECKOUT",e.ADD_CART="ADD_CART",e.ADD_BILLING="ADD_BILLING",e.INVITE="INVITE",e.CUSTOM_EVENT_1="CUSTOM_EVENT_1",e.CUSTOM_EVENT_2="CUSTOM_EVENT_2",e.CUSTOM_EVENT_3="CUSTOM_EVENT_3",e.CUSTOM_EVENT_4="CUSTOM_EVENT_4",e.CUSTOM_EVENT_5="CUSTOM_EVENT_5"}(A||(A={})),function(e){e.STAGE_ID="STAGE_ID",e.ONBOARDING_TIME="ONBOARDING_TIME",e.ENTRY="ENTRY",e.MATCH_TYPE="MATCH_TYPE",e.MATCH_ID="MATCH_ID",e.MATCH_TIME="MATCH_TIME",e.SHOP_TIME="SHOP_TIME",e.ITEM_ID="ITEM_ID",e.SOURCE="SOURCE",e.PAYMENT_TYPE="PAYMENT_TYPE",e.PRICE="PRICE",e.ITEM_CATEGORY="ITEM_CATEGORY",e.SUCCESS="SUCCESS",e.TRANSACTION_ID="TRANSACTION_ID",e.CURRENCY="CURRENCY",e.SEACH_STRING="SEARCH_STRING",e.PAGE_INFORMATION="PAGE_INFORMATION",e.PAYMENT_INFO_AVAILABLE="PAYMENT_INFO_AVAILABLE",e.NUMBER_ITEMS="NUMBER_ITEMS"}(I||(I={})),function(e){e.USER="USER",e.GROUP="GROUP"}(T||(T={})),function(e){e.ALLOW="ALLOW",e.DENY="DENY",e.NONE="NONE"}(m||(m={})),function(e){e.ACTIVITY_VISIBILITY="ACTIVITY_VISIBILITY"}(g||(g={}));var R=function(){return R=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},R.apply(this,arguments)},O=R(R({_device:{android:!1,ios:!1},_screenshotCompleteCallback:void 0,_b:void 0,_outsideSc:!1,_k:void 0,_h:{},_u:"",_m:new Map,app:void 0,version:"2.8.0"},n),{App:u,Events:s,User:d}),N=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},C=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))};function D(e){var t=sc._m.get(e);if(null==t)throw new Error("Unrecognized method name. Please check method-name-map.");return t}function y(e,t){if(sc._b)sc._b.registerHandler(e,t);else{var n=D(e);sc._h[n]=t}}var P,L,w=window;function U(e){if(w.pc){var t=w.pc.app;t.on("postrender",(function(){if(sc._screenshotCompleteCallback){var e=t.graphicsDevice.canvas.toDataURL();sc._screenshotCompleteCallback(e),sc._screenshotCompleteCallback=void 0}}))}y("setVolume",(function(t){w.pc&&(w.pc.app.systems.sound.volume=t),sc.app._volume=t,e(S.VOLUME_CHANGED,t)})),y("didTakeScreenshot",(function(e,t){sc._screenshotCompleteCallback=t})),y("adReady",(function(t){e(S.AD_READY,t)})),y("adComplete",(function(t){e(S.AD_COMPLETE,t)})),y("didLoseFocus",(function(t){e(S.DID_LOSE_FOCUS,t)})),y("didGainFocus",(function(t){e(S.DID_GAIN_FOCUS,t)})),y("safeAreaDidUpdate",(function(t){sc.app._safeAreaInsets=t.safeAreaInsets,e(S.SAFE_AREA_DID_UPDATE,t)})),y("didPresentLeaderboard",(function(t){e(S.DID_PRESENT_LEADERBOARD,t)})),y("didDismissLeaderboard",(function(t){e(S.DID_DISMISS_LEADERBOARD,t)})),y("didDismissLens",(function(t){e(S.DID_DISMISS_LENS,t)})),y("createShortcutComplete",(function(t){e(S.CREATE_SHORTCUT_COMPLETE,t)})),y("permissionsDidUpdate",(function(t){e(S.PERMISSIONS_DID_UPDATE,t)})),y("loadScriptFile",(function(e,t){void 0===e&&(e=[]),e.forEach((function(e){if("WCL"===e){var n=sc,o=window.console;o&&(n.ConsoleLogs=[],["info","log","warn","error"].forEach((function(e){return function(e){var t=o[e];o[e]=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];n.ConsoleLogs.push("["+(new Date).toUTCString()+"] "+e+": "+Array.prototype.slice.apply(r).join(" ")),n.ConsoleLogs.length>1e3&&n.ConsoleLogs.shift(),t.apply&&t.apply(o,r)}}(e)})),y("getConsoleLogs",(function(e,t){return t(n.ConsoleLogs)})))}else{if("MFPSM"!==e)return t({error:{code:v.UNKNOWN_SCRIPT,message:e}});var r=0,i={lastFiveFps:[],lastSixtyFps:[],lastFiveFpsSum:0,lastSixtyFpsSum:0,averageFpsLastFiveSec:0,averageFpsLastSixtySec:0,lowestAverageFpsForFiveSec:Number.MAX_VALUE,numFrames:0,timer:0,goodSeconds:[],currentSecondIsGood:!0,goodSecondsCount:0};if(y("getTestAutomationMetrics",(function(e,t){t({metrics:{AVERAGE_FPS_60S:i.averageFpsLastSixtySec,LOWEST_AVG_FPS_5S:i.lowestAverageFpsForFiveSec,GOOD_SECONDS_COUNT:i.goodSecondsCount}})})),w.pc){var a=w.pc;a.app.on("update",(function(e){if(i.numFrames++,0!=r){var t=a.now()-r;if(r+=t,i.timer+=t,t>50&&(i.currentSecondIsGood=!1),i.timer>=1e3){for(i.lastFiveFpsSum+=i.numFrames,i.lastFiveFps.push(i.numFrames);i.lastFiveFps.length>5;)i.lastFiveFpsSum-=i.lastFiveFps.shift()||0;for(i.lastSixtyFpsSum+=i.numFrames,i.lastSixtyFps.push(i.numFrames);i.lastSixtyFps.length>60;)i.lastSixtyFpsSum-=i.lastSixtyFps.shift()||0;for(i.numFrames<30&&(i.currentSecondIsGood=!1),1==i.currentSecondIsGood?(i.goodSeconds.push(1),i.goodSecondsCount+=1):i.goodSeconds.push(0);i.goodSeconds.length>60;)i.goodSecondsCount-=i.goodSeconds.shift()||0;i.averageFpsLastFiveSec=Math.round(i.lastFiveFpsSum/i.lastFiveFps.length),i.averageFpsLastSixtySec=Math.round(i.lastSixtyFpsSum/i.lastSixtyFps.length),5==i.lastFiveFps.length&&(i.lowestAverageFpsForFiveSec=Math.min(i.lowestAverageFpsForFiveSec,i.averageFpsLastFiveSec)),i.numFrames=0,i.currentSecondIsGood=!0,i.timer-=1e3}}else r=a.now()}))}}})),t()}))}function F(e){switch(e){case 0:return P.OK;case 3:return P.INVALID_ARGUMENT;case 5:return P.NOT_FOUND;case 7:return P.PERMISSION_DENIED;default:return P.INTERNAL_ERROR}}function k(e){if(!e)return[];try{return e.map((function(e){var t,n=e.entry;return{entry:{key:n.key,value:n.value?JSON.parse((t=n.value,decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join("")))):void 0},status:{code:e.status.code?F(e.status.code):P.OK}}}))}catch(e){throw new Error("Failed to deserialize cloud storage data. ".concat(e.message))}}function M(e){try{return e.map((function(e){return{key:e.key,value:e.value?(t=JSON.stringify(e.value),btoa(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode(Number("0x"+t))})))):void 0};var t}))}catch(e){throw new Error("Failed to serialize cloud storage data. ".concat(e.message))}}!function(e){e.OK="OK",e.INVALID_ARGUMENT="INVALID_ARGUMENT",e.NOT_FOUND="NOT_FOUND",e.PERMISSION_DENIED="PERMISSION_DENIED",e.INTERNAL_ERROR="INTERNAL_ERROR"}(P||(P={})),function(e){e.USER="USER",e.SESSION="SESSION",e.APP="APP"}(L||(L={}));var V=function(){function e(e,t){void 0===t&&(t="dev"),this.sc=e,this.env=t}return e.getPath=function(e,t){var n="https://gcp.api.snapchat.com/games/storage/v1/";switch(e){case L.USER:n+="user/";break;case L.SESSION:n+="session/";break;case L.APP:n+="app/";break;default:return Promise.reject({code:v.INVALID_PARAM,message:'scope: "'.concat(e,'" is not supported')})}return n+=t,Promise.resolve(n)},e.prototype.doFetch=function(e,t){return n=this,o=void 0,i=function(){var n,o,r,i,a;return function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}(this,(function(s){switch(s.label){case 0:return[4,this.sc.fetchAuthToken()];case 1:return n=s.sent(),o=new AbortController,r=setTimeout((function(){return o.abort()}),1e3),[4,fetch(e,{method:"POST",headers:(a={Authorization:"Bearer ".concat(n.token)},a["x-snap-games-app-env"]=this.sc._outsideSnapchat()?this.env:"",a),body:t}).then((function(e){if(e.status>=200&&e.status<300)return e.json();switch(e.status){case 400:throw{code:v.INVALID_PARAM,message:e.statusText};case 403:throw{code:v.INVALID_CONFIG,message:"app is not authorized to use this method"};case 429:throw{code:v.RATE_LIMITED,message:"rate limited"};default:throw{code:v.INTERNAL_ERROR,message:"internal error"}}}))];case 2:return i=s.sent(),clearTimeout(r),[2,i]}}))},new((r=void 0)||(r=Promise))((function(e,t){function a(e){try{c(i.next(e))}catch(e){t(e)}}function s(e){try{c(i.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(a,s)}c((i=i.apply(n,o||[])).next())}));var n,o,r,i},e.prototype.getData=function(t,n,o){var r=this,i={collection:n,keys:o};return e.getPath(t,"getData").then((function(e){return r.doFetch(e,JSON.stringify(i))})).then((function(e){return{responses:k(e.responses)}}))},e.prototype.scanData=function(t,n,o,r){var i=this;void 0===r&&(r="");var a={collection:n,cursor:r,limit:o};return e.getPath(t,"scanData").then((function(e){return i.doFetch(e,JSON.stringify(a))})).then((function(e){return{responses:k(e.responses),cursor:e.cursor}}))},e.prototype.setData=function(t,n,o,r){var i=this;if(void 0===r&&(r=0),t===L.APP)throw new Error("Can not set cloud storage app data.");var a={collection:n,data:M(o),permission:1};return r>0&&(a.ttl_sec=r),e.getPath(t,"putData").then((function(e){return i.doFetch(e,JSON.stringify(a))}))},e.prototype.deleteData=function(t,n,o){var r=this;if(t===L.APP)throw new Error("Can not delete cloud storage app data.");var i={collection:n,keys:o};return e.getPath(t,"deleteData").then((function(e){return r.doFetch(e,JSON.stringify(i))}))},e}(),G=function(){return G=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},G.apply(this,arguments)},x=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},H=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},B=window;var j=new Map([["initialize","I"],["playWithFriends","PWF"],["fetchAuthToken","FAT"],["loadingComplete","LC"],["setLoadingProgress","SLP"],["submitLeaderboardScore","SLS"],["presentLeaderboard","PL"],["fetchAvatar2D","FA2D"],["fetchAvatar3D","FA3D"],["localStorageSetData","LSSD"],["localStorageGetData","LSGD"],["localStorageDeleteData","LSDD"],["presentPrivacyPolicy","PPP"],["presentTermsOfService","PTOS"],["presentWebpage","PW"],["shareMediaToSnapchat","SMTS"],["shareLensToSnapchat","SLTS"],["logEvent","LE"],["shareAppToChat","SATC"],["getShareInfo","GSI"],["presentReportUI","PRUI"],["getUnconsumedPurchases","GUP"],["getAllProducts","GAP"],["getProducts","GP"],["purchase","P"],["consumePurchase","CP"],["isTokenShopSupported","ITSS"],["sendCustomUpdateToChat","SCUTC"],["sendUpdateNotification","SUN"],["switchAppSession","SAS"],["fetchOAuth2Token","FOA2T"],["onSubmitPayment","OSP"],["onPaymentCanceled","OPC"],["onShippingAddressChanged","OSAC"],["getDiscoverableFriends","GDF"],["switchToFriend","STF"],["getPermissions","GP2"],["requestPermission","RP"],["getUnconsumedAds","GUA"],["initializeAds","IA"],["watchAd","WA"],["consumeAd","CA"],["isAdReady","IAR"],["startLoggingFPS","SLF"],["endLoggingFPS","ELF"],["canCreateShortcut","CCS"],["createShortcut","CS"],["setVolume","SV"],["didTakeScreenshot","DTS"],["adReady","AR"],["adComplete","AC"],["didLoseFocus","DLF"],["didGainFocus","DGF"],["safeAreaDidUpdate","SADU"],["getConsoleLogs","GCL"],["didPresentLeaderboard","DPL"],["didDismissLeaderboard","DDL"],["didDismissLens","DDLE"],["getTestAutomationMetrics","GTAM"],["loadScriptFile","LSF"],["createShortcutComplete","CSC"],["permissionsDidUpdate","PDU"]]),Y=window,W=function(e){var t=e.headers.get("content-type");return t&&t.includes("application/json")?e.json():e.text()},K=function(e,t,n){return o=void 0,r=void 0,a=function(){var o,r;return function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}(this,(function(i){switch(i.label){case 0:o=sc._u+"C/".concat(e,"?k=")+encodeURIComponent(sc._k)+(t?"&m=".concat(encodeURIComponent(JSON.stringify(t))):"")+(n?"&rid=".concat(encodeURIComponent(n)):""),i.label=1;case 1:return i.trys.push([1,4,,5]),[4,fetch(o)];case 2:return r=i.sent(),[4,W(r)];case 3:return[2,i.sent()];case 4:throw{error:i.sent()};case 5:return[2]}}))},new((i=void 0)||(i=Promise))((function(e,t){function n(e){try{c(a.next(e))}catch(e){t(e)}}function s(e){try{c(a.throw(e))}catch(e){t(e)}}function c(t){var o;t.done?e(t.value):(o=t.value,o instanceof i?o:new i((function(e){e(o)}))).then(n,s)}c((a=a.apply(o,r||[])).next())}));var o,r,i,a},z=function(){var e=sc._u+"C/LPE?k="+encodeURIComponent(sc._k);fetch(e).then((function(e){if(200!==e.status)return console.error(e.statusText),void setTimeout((function(){z()}),1e3);W(e).then((function(e){Array.isArray(e)&&e.forEach((function(e){if(e.t){var t=sc._h[e.t];t&&t(e.m,(function(t){e.rid&&function(e,t){K("LPR",t,e)}(e.rid,t)}))}}))})),z()})).catch((function(e){setTimeout((function(){z()}),1e3)}))},J=function(e,t,n,o,r,i){var a=this,s=G(G({},O),{_m:i,_outsideSc:!1,_storage:void 0,_timeoutSetup:function(){var e,t,o=(null===(e=null===navigator||void 0===navigator?void 0:navigator.userAgentData)||void 0===e?void 0:e.platform.toLowerCase())||(null===navigator||void 0===navigator?void 0:navigator.platform.toLowerCase())||"unknown";return o.indexOf("win")>-1||o.indexOf("mac")>-1?Promise.race([n(),new Promise((function(e,n){return t=setTimeout(n,100)}))]).finally((function(){return clearTimeout(t)})):n()},setLoadingProgress:function(t){return x(a,void 0,void 0,(function(){var n;return H(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,s._timeoutSetup()];case 1:return n=o.sent(),new Promise((function(o){n?n.callHandler("setLoadingProgress",{progress:t},o):o(e("setLoadingProgress",{progress:t}))})),[3,3];case 2:return o.sent(),console.log("setLoadingProgress to ".concat(t)),[3,3];case 3:return[2]}}))}))},loadingComplete:function(){return x(a,void 0,void 0,(function(){var t;return H(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,s._timeoutSetup()];case 1:return t=n.sent(),new Promise((function(n){t?t.callHandler("loadingComplete",{},n):n(e("loadingComplete",{}))})),[3,3];case 2:return n.sent(),console.log("LoadingComplete called from local"),[3,3];case 3:return[2]}}))}))},initialize:function(e){return x(a,void 0,void 0,(function(){var t,n,o,r,i,a,c,l;return H(this,(function(p){switch(p.label){case 0:return p.trys.push([0,3,,4]),[4,s._timeoutSetup()];case 1:return n=p.sent(),[4,s._initializeFromBridge(n)];case 2:return t=p.sent(),[3,4];case 3:return p.sent(),console.log("Failed to initialize bridge default to local"),t=s._initializeFromLocal(e),[3,4];case 4:return s.app=new u,s.app._id=t.applicationId,s.app._context=t.context,s.app._env=t.env,s.app._sessionId=t.sessionId,s.app._locale=t.locale,t.conversationSize&&(s.app._conversationSize=t.conversationSize),t.safeAreaInsets&&(s.app._safeAreaInsets=t.safeAreaInsets),t.safeAreaInsets&&(o=t.safeAreaInsets,r=o.top,i=o.bottom,a=window.devicePixelRatio,"number"==typeof r&&(c=Math.floor(r/a),document.documentElement.style.setProperty("--window-safe-area-inset-top","".concat(c,"px")),s.app._windowSafeAreaInsets.top=c),"number"==typeof i&&(l=Math.floor(i/a),document.documentElement.style.setProperty("--window-safe-area-inset-bottom","".concat(l,"px")),s.app._windowSafeAreaInsets.bottom=l)),t.volume?(s.app._volume=t.volume,B.pc&&(B.pc.app.systems.sound.volume=t.volume)):t.volume=0,t.user&&(s.app._user=new d(t.user.id,t.user.avatarId,t.user.name,t.user.color)),s._storage=new V(s,t.env),[2,G(G({},t),{user:s.app._user})]}}))}))},_initializeFromLocal:function(e){var t,n,o,r,i,a,c,u,l,p,f,h;s._outsideSc=!0;var _=new URLSearchParams(window.location.search),v=function(e){return e||null},S={applicationId:"test-app-id-".concat(Math.random().toString(36).substring(2,10)),context:"INDIVIDUAL",env:"dev",sessionId:"test-session-id",conversationSize:2,locale:navigator.language,volume:1},E={safeAreaInsets:G({top:100,bottom:100},null==e?void 0:e.safeAreaInsets)};return G(G(G(G({},S),e),E),{user:new d(null!==(o=null!==(t=v(_.get("userId")))&&void 0!==t?t:null===(n=null==e?void 0:e.user)||void 0===n?void 0:n.id)&&void 0!==o?o:"test-user-id",null!==(a=null!==(r=v(_.get("avatarId")))&&void 0!==r?r:null===(i=null==e?void 0:e.user)||void 0===i?void 0:i.avatarId)&&void 0!==a?a:"ebfa12e6-6b43-4867-a317-aeac1b846c17",null!==(l=null!==(c=v(_.get("username")))&&void 0!==c?c:null===(u=null==e?void 0:e.user)||void 0===u?void 0:u.name)&&void 0!==l?l:"test-username",null!==(h=null!==(p=v(_.get("color")))&&void 0!==p?p:null===(f=null==e?void 0:e.user)||void 0===f?void 0:f.color)&&void 0!==h?h:"#fffc00")})},_initializeFromBridge:function(n){return x(a,void 0,void 0,(function(){var i;return H(this,(function(a){switch(a.label){case 0:return s._outsideSc=!1,s._b=n,U(t),o(),[4,e("initialize",{minimumClientSupportedVersion:r})];case 1:return i=a.sent(),[2,G(G({},i),{user:new d(i.user.id,i.user.avatarId,i.user.name,i.user.color)})]}}))}))},_outsideSnapchat:function(){return s._outsideSc},fetchAuthToken:function(){return x(a,void 0,void 0,(function(){var t,n,o,r,i,a;return H(this,(function(c){switch(c.label){case 0:return s.app.authTokenExpiration>Date.now()+5e3?[2,{token:s.app.authToken}]:s._outsideSc?[3,2]:[4,e("fetchAuthToken")];case 1:return t=c.sent(),[3,5];case 2:return[4,fetch("".concat("https://gcp.api.snapchat.com/games/auth/get_test_token?","application_id=").concat(null===(o=s.app)||void 0===o?void 0:o._id)+"&user_id=".concat(null===(i=null===(r=s.app)||void 0===r?void 0:r._user)||void 0===i?void 0:i.id,"&session_id=").concat(null===(a=s.app)||void 0===a?void 0:a._sessionId))];case 3:return[4,c.sent().text()];case 4:n=c.sent(),t={token:n},c.label=5;case 5:return t.token&&(s.app.authToken=t.token),[2,t]}}))}))},_fetchOAuth2Token:function(){return e("fetchOAuth2Token")},fetchAvatar2D:function(t,n,o){return x(a,void 0,void 0,(function(){return H(this,(function(r){return s._outsideSc?[2,{url:"localTesting"}]:[2,e("fetchAvatar2D",{avatarId:t,variant:n,size:o})]}))}))},fetchAvatar3D:function(t){return x(a,void 0,void 0,(function(){return H(this,(function(n){return s._outsideSc?[2,{url:"localTesting"}]:[2,e("fetchAvatar3D",{avatarId:t})]}))}))},playWithFriends:function(t){return x(a,void 0,void 0,(function(){var n;return H(this,(function(o){switch(o.label){case 0:if(s._outsideSc)throw"cannot call play with friends from local";return[4,e("playWithFriends",{maxNumberOfPlayers:t})];case 1:return n=o.sent(),s.app.updateSession(n.sessionId,n.conversationSize,"CONVERSATION"),s.app._user=new d(n.user.id,n.user.avatarId,n.user.name,n.user.color),[2,n]}}))}))},getUnconsumedAds:function(){return x(a,void 0,void 0,(function(){return H(this,(function(t){return s._outsideSc?[2,{unconsumedAds:[]}]:[2,e("getUnconsumedAds")]}))}))},initializeAds:function(t){return x(a,void 0,void 0,(function(){return H(this,(function(n){return s._outsideSc?[2,{url:"localTesting"}]:[2,e("initializeAds",{slotIds:t})]}))}))},isAdReady:function(t){return x(a,void 0,void 0,(function(){return H(this,(function(n){return s._outsideSc?[2,{isReady:!1}]:[2,e("isAdReady",{slotId:t})]}))}))},watchAd:function(t,n){return x(a,void 0,void 0,(function(){return H(this,(function(o){return s._outsideSc?[2,{requestId:"localTesting"}]:[2,e("watchAd",{slotId:t,developerPayload:n})]}))}))},consumeAd:function(t){return x(a,void 0,void 0,(function(){return H(this,(function(n){if(s._outsideSc){if("localTesting"===t)return[2];throw"cannot consume ad on local"}return[2,e("consumeAd",{requestId:t})]}))}))},localStorageSetData:function(t){return e("localStorageSetData",{data:t})},localStorageGetData:function(t){return e("localStorageGetData",{keys:t})},localStorageDeleteData:function(t){return e("localStorageDeleteData",{keys:t})},cloudStorageSetData:function(e,t,n,o){return void 0===o&&(o=0),s._storage.setData(e,t,n,o)},cloudStorageGetData:function(e,t,n){return s._storage.getData(e,t,n)},cloudStorageScanData:function(e,t,n,o){return void 0===n&&(n=100),void 0===o&&(o=""),s._storage.scanData(e,t,n,o)},cloudStorageDeleteData:function(e,t,n){return s._storage.deleteData(e,t,n)},presentPrivacyPolicy:function(){return e("presentPrivacyPolicy")},presentTermsOfService:function(){return e("presentTermsOfService")},startLoggingFPS:function(){return x(a,void 0,void 0,(function(){return H(this,(function(t){switch(t.label){case 0:return B.Android?[4,e("startLoggingFPS")]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},endLoggingFPS:function(t){return x(a,void 0,void 0,(function(){return H(this,(function(n){switch(n.label){case 0:return B.Android?[4,e("endLoggingFPS",{success:t})]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},shareLensToSnapchat:function(t,n,o,r){return void 0===n&&(n={path:"",payload:""}),void 0===r&&(r=!1),e("shareLensToSnapchat",{lensUUID:t,shareInfo:n,lensLaunchData:o,enableFullScreenMode:r}).then((function(){return new Promise((function(e){s.app.once("didDismissLens",e)}))}))},shareMediaToSnapchat:function(t,n){return void 0===n&&(n={path:"",payload:""}),e("shareMediaToSnapchat",{stickers:t,shareInfo:n})},logEvent:function(t,n){return x(a,void 0,void 0,(function(){var o;return H(this,(function(r){switch(r.label){case 0:return[4,e("logEvent",{eventName:t,parameters:n})];case 1:return o=r.sent(),s._outsideSc?[2,{success:!0}]:[2,o]}}))}))},submitLeaderboardScore:function(t,n){return x(a,void 0,void 0,(function(){var o;return H(this,(function(r){switch(r.label){case 0:return[4,e("submitLeaderboardScore",{leaderboardId:t,score:n})];case 1:return o=r.sent(),s._outsideSc?[2,{success:!0}]:[2,o]}}))}))},presentLeaderboard:function(t){return x(a,void 0,void 0,(function(){var n;return H(this,(function(o){return n=e("presentLeaderboard",{leaderboardId:t}),s._outsideSc?[2,{success:!0}]:[2,n]}))}))},shareAppToChat:function(t,n,o){return void 0===o&&(o={path:"",payload:""}),e("shareAppToChat",{shareCard:t,imageShareCard:n,shareInfo:o})},getShareInfo:function(){return x(a,void 0,void 0,(function(){return H(this,(function(t){return s._outsideSc?[2,{shareInfo:{path:"",payload:""}}]:[2,e("getShareInfo")]}))}))},presentWebpage:function(t){return e("presentWebpage",{url:t})},getUnconsumedPurchases:function(){return x(a,void 0,void 0,(function(){return H(this,(function(t){return s._outsideSc?[2,{purchases:[]}]:[2,e("getUnconsumedPurchases")]}))}))},getAllProducts:function(){return x(a,void 0,void 0,(function(){return H(this,(function(t){return s._outsideSc?[2,{products:[]}]:[2,e("getAllProducts",{})]}))}))},getProducts:function(t){return x(a,void 0,void 0,(function(){return H(this,(function(n){return s._outsideSc?[2,{products:[]}]:[2,e("getProducts",{skus:t})]}))}))},purchase:function(t){if(s._outsideSc)throw"cannot purchase on local";return e("purchase",{sku:t})},consumePurchase:function(t){if(s._outsideSc)throw"cannot purchase on local";return e("consumePurchase",{transactionId:t})},isTokenShopSupported:function(){return x(a,void 0,void 0,(function(){return H(this,(function(t){return s._outsideSc?[2,{isEnabled:!1}]:[2,e("isTokenShopSupported")]}))}))},switchAppSession:function(t){return x(a,void 0,void 0,(function(){var n;return H(this,(function(o){switch(o.label){case 0:if(s._outsideSc)throw"cannot switch app session from local";return[4,e("switchAppSession",{targetSessionId:t})];case 1:return n=o.sent(),s.app.updateSession(t,n.conversationSize,n.context),[2,n]}}))}))},validateAgeThreshold:function(){return x(a,void 0,void 0,(function(){return H(this,(function(e){return s._outsideSc?[2,{isAgeValid:!0}]:void 0!==s.app.isAgeValid?[2,Promise.resolve({isAgeValid:s.app.isAgeValid})]:[2,h(f,2)]}))}))},fetchSessions:function(){return x(a,void 0,void 0,(function(){return H(this,(function(e){return s._outsideSc?[2,{sessions:[]}]:[2,p("query { me { connection { sessions { sessionID participantsCount} } } }").then((function(e){var t,n,o,r=null===(o=null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.me)||void 0===n?void 0:n.connection)||void 0===o?void 0:o.sessions;if(r)return{sessions:r.map((function(e){return{sessionId:e.sessionID,participantCount:e.participantsCount}}))};throw{code:s.ErrorCodes.INTERNAL_ERROR}}))]}))}))},fetchParticipants:function(e){return x(a,void 0,void 0,(function(){var t;return H(this,(function(n){return s._outsideSc?[2,{participants:{}}]:e.length>10?[2,Promise.reject(s.ErrorCodes.INVALID_PARAM)]:(t=JSON.stringify(e),[2,p("query { me { connection { participants(sessionIDs: ".concat(t," ) { ").concat("participants { abbreviatedDisplayName externalAvatarID externalUserID} sessionID"," } } } }")).then((function(e){var t,n,o,r=null===(o=null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.me)||void 0===n?void 0:n.connection)||void 0===o?void 0:o.participants;if(r){var i={};return r.forEach((function(e){var t=e.sessionID;i[t]=e.participants.map((function(e){return{id:e.externalUserID,name:e.abbreviatedDisplayName,avatarId:e.externalAvatarID}}))})),{participants:i}}throw{code:s.ErrorCodes.INTERNAL_ERROR}}))])}))}))},getDiscoverableFriends:function(){return x(a,void 0,void 0,(function(){return H(this,(function(e){return s._outsideSc?[2,{friends:[]}]:void 0!==s.app.discoverableFriends?[2,Promise.resolve({friends:s.app.discoverableFriends})]:[2,b()]}))}))},switchToFriend:function(t){if(s._outsideSc)throw"cannot switch to friend from local";return e("switchToFriend",{friendId:t}).then((function(e){if(!e.sessionId)throw{code:s.ErrorCodes.CLIENT_STATE_INVALID};return s.app.updateSession(e.sessionId,2,"CONVERSATION"),e}))},sendUpdateNotification:function(t,n){return e("sendUpdateNotification",{updateId:t,inputs:n})},sendCustomUpdateToChat:function(t,n,o,r){return void 0===r&&(r={path:"",payload:""}),e("sendCustomUpdateToChat",{updateId:t,inputs:n,bitmojiVariant:o,shareInfo:r})},getPermissions:function(t){return x(a,void 0,void 0,(function(){return H(this,(function(n){return s._outsideSc?[2,{permissions:{ACTIVITY_VISIBILITY:{permissionScope:g.ACTIVITY_VISIBILITY,permissionValue:m.ALLOW}}}]:[2,e("getPermissions",{permissionScopes:t})]}))}))},requestPermission:function(t){return x(a,void 0,void 0,(function(){return H(this,(function(n){return s._outsideSc?[2,{permissions:{ACTIVITY_VISIBILITY:{permissionScope:g.ACTIVITY_VISIBILITY,permissionValue:m.ALLOW}}}]:[2,e("requestPermission",{permissionScope:t})]}))}))},canCreateShortcut:function(){return s._device.android?e("canCreateShortcut"):Promise.resolve({canCreate:!1,failureReason:s.ErrorCodes.CLIENT_UNSUPPORTED})},createShortcut:function(){return s._device.android?e("createShortcut"):new Promise((function(e,t){t({code:s.ErrorCodes.CLIENT_UNSUPPORTED})}))}});return s}((function(e,t){if(void 0===t&&(t={}),sc._outsideSc)return console.log("Calling: ".concat(e," with ").concat(JSON.stringify(t))),new Promise((function(e,t){e({})}));if(sc._b)return new Promise((function(n,o){var r;null===(r=sc._b)||void 0===r||r.callHandler(e,t,(function(e){e&&e.error?o(e.error):n(e)}))}));var n=D(e);return K(n,t).then((function(e){return new Promise((function(t,n){e&&e.error?n(e.error):t(e)}))}))}),(function(e){for(var t,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];(t=sc.app).emit.apply(t,C([e],N(n),!1))}),(function(){return new Promise((function(e,t){if(Y.Android)if(sc._device.android=!0,Y.bridge)e(Y.bridge);else{var n=Y.jsBridgeSetupCallback;Y.jsBridgeSetupCallback=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];n&&n.apply(this,t),e.apply(this,t)}}else{if(sc._device.ios=!0,sc._k)return void e(void 0);for(var o=document.location.search.substring(1).split("&"),r=void 0,i=void 0,a=void 0,s=0;s<o.length;s++){var c=o[s].split("="),u=decodeURIComponent(c[0]);"k"==u?i=decodeURIComponent(c[1]):"b"===u?r=decodeURIComponent(c[1]):"p"===u&&(a=decodeURIComponent(c[1]))}if(r&&"js"!==r){if(i||console.warn("Missing k"),a){var l=location.pathname.replace(/[^/]*\.[^/.]+$/,"").replace(/(^\/)|(\/$)/g,"");sc._u="http://127.0.0.1:".concat(a,"/").concat(l?l+"/":"")}sc._k=i,e(void 0)}else{if(Y.WebViewJavascriptBridge)return e(Y.WebViewJavascriptBridge);var d=function(n){n&&e(n),t("no bridge from iOS")};if(Y.WVJBCallbacks)return Y.WVJBCallbacks.push(d);Y.WVJBCallbacks=[d];var p=document.createElement("iframe");p.style.display="none",p.src="https://__bridge_loaded__",document.documentElement.appendChild(p),setTimeout((function(){return document.documentElement.removeChild(p)}),0)}}}))}),(function(){sc._b||z()}),20220531,j);"undefined"!=typeof window&&(window.sc=J);const q=J;return t.default})()}));